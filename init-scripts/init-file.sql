USE trains;
INSERT INTO marshrut_confs (id_marshrut, vagon_ord_num, id_vagon_category, name_vagon_category, id_vagon_type, id_perevozchik, perevozchik_name, coupe_num, seat_num, seat_placement, is_invalid, gender_constraints, id_service_class, service_class_code, price_basic, k) SELECT DISTINCT id_marshrut, vagon_ord_num, vcat.id_vagon_category, vcat.name_vagon_category, sc.id_vagon_type, p.id_perevozchik, p.`name` as perevozchik_name, coupe_num, seat_num, seat_placement, is_invalid, gender_constraints, srvc.id_service_class, srvc.service_class_code, price_basic, k from marshrut as m inner join sostav_conf as sc using(id_sostav_type) inner join vagon_conf as vc on (sc.id_vagon_type=vc.id_vagon_type) inner join vagon_type as vt on (vc.id_vagon_type=vt.id_vagon_type) inner join vagon_category as vcat using(id_vagon_category) inner join service_class AS srvc ON sc.id_service_class=srvc.id_service_class inner join perevozchik as p ON vt.id_perevozchik=p.id_perevozchik; 
